<!DOCTYPE html>
<html xmlns = "http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<title>Parabola</title>
</head>
<style type="text/css" media="Screen">
a{text-decoration:none;color:blue;}
a:hover{text-decoration:underline;}
a:visited{color:blue;}
li{list-style-type:none;cursor:pointer;padding-left: 7px;padding-right: 27px;}
//li{list-style-type:none;cursor:pointer;padding-left: 7px;outline: 1px solid black}
//ul{margin-right:auto;widthq:100%}
//td{cursor:pointer;}
sub{font-size:0.83rem;}
sup{font-size:0.83rem;}
//ul{display:flex;flex-direction:column-reverse;}
</style>
<body style="font-family:Arial;white-space:pre;line-height:0;"
><canvas id="canvas" width="150" height="150"></canvas><span id="listc" style="float:left;line-height:0.9;position: absolute;top:0;bottom:0;padding-bottom:32px;left:10px;right:0;overflow-x:overlay;overflow-y:auto;flex-direction:column-reverse;" onmousedown="return false"><br/><br/></span><script
>'use strict'

function getw(n)
{
let w=Math.floor(1000/n);
if(w>51)
   w=51;
else if(w<3)
   w=3;
return w;
}

function addtable(n)
{
let tar=[];
let car=[];
for(let e=0;e<n;e++)
   car.push(0);
   
let maxc=0;
for(let e=0;e<n;e++)
   {let i=e*e%n;
   tar.push(i);
   car[i]++;
   if(car[i]>maxc)
      maxc++;
   }

let to=1.5;

let t;
let w=getw(n);

let fsize=Math.floor(w*0.5);
if(fsize>16)
   fsize=16;



listc.lastChild.remove();

t=document.createElement('span');
t.border=2;
t.cellPadding=0;
t.style.textAlign='center';
t.style.borderSpacing='0';
t.style.marginRight='10px';
if(n>2)
   t.innerHTML+='<span><br/><br/><br/><br/>N = '+n+'</span><br/><br/>';
else
	t.innerHTML+='<span><br/>N = '+n+'</span><br/><br/>';
/*let nn=document.createElement('span');
nn.innerHTML='N = '+n;
r.appendChild(nn);*/

//for(let e=0;e<n;e++)
   {let r=document.createElement('span');
   //for(let i=0;i<n;i++)
      {let d=document.createElement('span');
      //d.style.width=w-1+'px';
      //d.style.height=w-1+'px';
      d.style.width=w*n+'px';
      d.style.height=w*n+'px';
      //if(tar[i]==n-1-e)
      //   d.style.background='#a0ffa0';
      d.style.border='none';
      //d.style.borderLeft='none';
      //d.style.borderTop='none';
      let s=document.createElement('svg');
      s.setAttribute('width',w*(n+5));
      s.setAttribute('height',w*(n+maxc+to));
      
      for(let e=0;e<n;e++)
      {let re=document.createElement('rect');
      re.setAttribute('id','r'+n+' '+e);
      re.setAttribute('x',(e)*w);
      /*Object.defineProperty(re,'y',{
         get: function(){
            return this.getAttribute('y');
            //return y;
            },
         set: function(n){
            this.setAttribute('y',n);
            //y=n;
            }
         });
      re.y=(n-tar[e]-1)*w;*/
      re.setAttribute('y',(n-tar[e]-1)*w);
      re.setAttribute('width',w);
      re.setAttribute('height',w);
      re.style.fill='#ff0000';
      s.appendChild(re);
      
      re=document.createElement('rect');
      re.setAttribute('x',(e)*w);
      re.setAttribute('y',w*(n+maxc-car[e]+to));
      re.setAttribute('width',w-1);
      re.setAttribute('height',w*car[e]);
      re.style.fill='#a0d7d7';
      s.appendChild(re);
      }
      
      for(let e=0;e<=n;e++)
      {let li=document.createElement('line');
      li.setAttribute('x1',w*e+(e?-0.5:0.5));
      li.setAttribute('y1',0);
      li.setAttribute('x2',w*e+(e?-0.5:0.5));
      li.setAttribute('y2',w*n);
      li.setAttribute('stroke','black');
      //li.setAttribute('stroke-width',0.5);
      s.appendChild(li);
      
      li=document.createElement('line');
      li.setAttribute('x1',0);
      li.setAttribute('y1',w*e+(e?-0.5:0.5));
      li.setAttribute('x2',w*n);
      li.setAttribute('y2',w*e+(e?-0.5:0.5));
      li.setAttribute('stroke','black');
      s.appendChild(li);}
      
      for(let e=0;e<n;e++)
      {let t=document.createElement('text');
      t.setAttribute('x',n*w+7);
      t.setAttribute('y',(e+0.6)*w);
      t.setAttribute('font-size',fsize+'px');
      t.innerHTML=n-e-1;
      t.style.font=fsize+'px';
      s.appendChild(t);
      
      t=document.createElement('text');
      t.setAttribute('id','t'+n+' '+e);
      t.setAttribute('x',(e+0.5)*w);
      t.setAttribute('y',n*w+fsize+1);
      t.setAttribute('font-size',fsize+'px');
      t.setAttribute('text-anchor','middle');
      t.innerHTML=e;
      t.style.font=fsize+'px';
      s.appendChild(t);
      
      t=document.createElement('text');
      t.setAttribute('x',(e+0.5)*w);
      t.setAttribute('y',(n+maxc-car[e]+to-0.5)*w+fsize-1);
      t.setAttribute('font-size',fsize+'px');
      t.setAttribute('text-anchor','middle');
      t.innerHTML=car[e];
      t.style.font=fsize+'px';
      s.appendChild(t);
      }
      
      d.appendChild(s);
      
      r.appendChild(d);
      }
   t.appendChild(r); 
   }
listc.appendChild(t); 

listc.innerHTML+='<br/>';
listc.innerHTML+='<span style="cursor:pointer;"><br/><br/><i id="addtable">Add table (use "Space" key)</i><br/><br/><br/><i id="addtables">Add 10 tables (use "Enter" key)</i><br/><br/><br/><i id="switchmode">Switch (0, N) and (- N / 2, N / 2) modes (use "M" key)</i></span>';
}

document.addEventListener('keydown',function(e){
if(!e.ctrlKey){
let c=e.code;
if(c=='Space'){
   nextn++;
   addtable(nextn);
   listc.scrollTop=listc.scrollHeight;
   }
else if(c=='Enter')
   {for(let e=0;e<10;e++)
      {nextn++;
      addtable(nextn);
      }
   listc.scrollTop=listc.scrollHeight;
   }
else if(c=='KeyM')
   {
   mode=1-mode;
   for(let n=2;n<=nextn;n++)
      {let w=getw(n);
      let to=Math.floor(n/2-0.5);
      for(let e=0;e<n;e++)
         {
         let re=document.getElementById('r'+n+' '+e);
         re.setAttribute('x',((e+mode*to)%n)*w);
         let t=document.getElementById('t'+n+' '+e);
         t.innerHTML=e-mode*to;
         }
      }
   }
}}
);

listc.onclick=function(e){
if(e.target.id=='addtable')
   {nextn++;
   addtable(nextn);
   listc.scrollTop=listc.scrollHeight;}
   else if(e.target.id=='addtables')
   {for(let e=0;e<10;e++)
      {nextn++;
      addtable(nextn);
      }
   listc.scrollTop=listc.scrollHeight;
   }
   else if(e.target.id=='switchmode')
      {
      mode=1-mode;
      for(let n=2;n<=nextn;n++)
         {let w=getw(n);
         let to=Math.floor(n/2-0.5);
         for(let e=0;e<n;e++)
            {
            let re=document.getElementById('r'+n+' '+e);
            re.setAttribute('x',((e+mode*to)%n)*w);
            let t=document.getElementById('t'+n+' '+e);
            t.innerHTML=e-mode*to;
            }
         }
      }
}



let mode=0;
let nextn=10;

for(let e=2;e<=nextn;e++)
   addtable(e);





</script></div></body></html>
